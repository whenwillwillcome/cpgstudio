document.addEventListener('DOMContentLoaded', () => {
  const sections = document.querySelectorAll('.section');
  const fullpage = document.getElementById('fullpage');
  const navDotsContainer = document.getElementById('nav-dots');

  let currentSectionIndex = 0;
  let isAnimating = false;
  let touchStartY = 0;

  // Create navigation dots
  sections.forEach((_, index) => {
    const dot = document.createElement('div');
    dot.classList.add('nav-dot');
    if (index === 0) dot.classList.add('active');
    dot.addEventListener('click', () => scrollToSection(index));
    navDotsContainer.appendChild(dot);
  });

  const navDots = document.querySelectorAll('.nav-dot');

  const scrollToSection = (index) => {
    if (index < 0 || index >= sections.length || isAnimating) return;
    isAnimating = true;
    currentSectionIndex = index;

    sections[index].scrollIntoView({ behavior: 'smooth' });
    updateActiveDot();

    setTimeout(() => {
      isAnimating = false;
    }, 900);
  };

  const updateActiveDot = () => {
    navDots.forEach((dot, i) => {
      dot.classList.toggle('active', i === currentSectionIndex);
    });
  };

  const handleScroll = (event) => {
    if (isAnimating) return;

    if (event.deltaY > 0 && currentSectionIndex < sections.length - 1) {
      scrollToSection(currentSectionIndex + 1);
    } else if (event.deltaY < 0 && currentSectionIndex > 0) {
      scrollToSection(currentSectionIndex - 1);
    }
  };

  const handleTouchStart = (event) => {
    touchStartY = event.touches[0].clientY;
  };

  const handleTouchMove = (event) => {
    if (isAnimating) return;

    const touchEndY = event.touches[0].clientY;
    const touchDiff = touchStartY - touchEndY;

    if (touchDiff > 50 && currentSectionIndex < sections.length - 1) {
      scrollToSection(currentSectionIndex + 1);
    } else if (touchDiff < -50 && currentSectionIndex > 0) {
      scrollToSection(currentSectionIndex - 1);
    }
  };

  const handleKeydown = (event) => {
    if (isAnimating) return;

    if (event.key === 'ArrowDown' || event.key === 'PageDown') {
      if (currentSectionIndex < sections.length - 1) {
        scrollToSection(currentSectionIndex + 1);
      }
    } else if (event.key === 'ArrowUp' || event.key === 'PageUp') {
      if (currentSectionIndex > 0) {
        scrollToSection(currentSectionIndex - 1);
      }
    }
  };

  document.addEventListener('wheel', handleScroll, { passive: false });
  document.addEventListener('touchstart', handleTouchStart, { passive: false });
  document.addEventListener('touchmove', handleTouchMove, { passive: false });
  document.addEventListener('keydown', handleKeydown);
});
